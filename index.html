<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Simule sua economia com energia solar e descubra quantas placas solares voc√™ precisa para sua casa ou empresa.">
  <title>Simulador Solar - Ecopower</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --primary-color: #F9A825;
      --primary-dark: #D18C20;
      --secondary-color: #0288D1;
      --secondary-dark: #01579B;
      --text-color: #1A237E;
      --text-light: #3F51B5;
      --background-light: #E3F2FD;
      --white: #FFFFFF;
      --error-color: #D32F2F;
      --success-color: #388E3C;
      --border-radius: 12px;
      --shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      --whatsapp-color: #25D366;
      --focus-ring: 0 0 0 3px rgba(249, 168, 37, 0.4);
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: 'Inter', Arial, sans-serif;
      background: var(--background-light) url('https://images.unsplash.com/photo-1509391366360-2e505a8eb702?crop=entropy&cs=tinysrgb&fit=max&fm=webp&q=80&w=1080') no-repeat center center fixed;
      background-size: cover;
      color: var(--text-color);
      padding: 20px;
      max-width: 900px;
      margin: auto;
      line-height: 1.6;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }

    .sr-only {
      position: absolute;
      width: 1px;
      height: 1px;
      padding: 0;
      margin: -1px;
      overflow: hidden;
      clip: rect(0, 0, 0, 0);
      white-space: nowrap;
      border-width: 0;
    }

    @media (prefers-reduced-motion: reduce) {
      * {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
        scroll-behavior: auto !important;
      }
    }

    @media (max-width: 768px) {
      body {
        background-attachment: scroll;
        background-position: center top;
        padding: 15px;
      }
      .form-section {
        padding: 15px;
      }
      input, button, select {
        font-size: 0.9rem;
        padding: 10px;
      }
    }

    h1, h2, h3 {
      color: var(--text-color);
      line-height: 1.3;
    }

    h1 {
      text-align: center;
      font-size: 2.2rem;
      margin-bottom: 20px;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
    }

    h2 {
      font-size: 1.8rem;
      margin-bottom: 15px;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    h3 {
      font-size: 1.4rem;
      margin-bottom: 12px;
    }

    input, button, select {
      display: block;
      margin: 10px 0;
      padding: 12px;
      width: 100%;
      border-radius: var(--border-radius);
      border: 1px solid #ddd;
      background-color: var(--white);
      font-size: 1rem;
      transition: all 0.2s ease;
    }

    input:focus, button:focus, select:focus {
      outline: none;
      box-shadow: var(--focus-ring);
      border-color: var(--primary-color);
    }

    button {
      background-color: var(--primary-color);
      color: var(--white);
      border: none;
      cursor: pointer;
      font-weight: 600;
      transition: background-color 0.2s ease, transform 0.1s ease;
    }

    button:hover, button:focus {
      background-color: var(--primary-dark);
      transform: translateY(-1px);
    }

    button:active {
      transform: translateY(0);
    }

    button:disabled {
      background-color: #cccccc;
      cursor: not-allowed;
      transform: none;
    }

    #submit-btn {
      background: linear-gradient(45deg, var(--primary-color), var(--primary-dark));
      padding: 16px 24px;
      font-size: 1.2rem;
      font-weight: 700;
      text-transform: uppercase;
      border-radius: 16px;
      box-shadow: 0 6px 16px rgba(249, 168, 37, 0.4);
      border: 2px solid var(--white);
    }

    #submit-btn:hover, #submit-btn:focus {
      background: linear-gradient(45deg, var(--primary-dark), var(--primary-color));
      box-shadow: 0 8px 20px rgba(249, 168, 37, 0.6);
      transform: scale(1.05);
    }

    .whatsapp-btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
      background: linear-gradient(45deg, var(--whatsapp-color), #1EBE54);
      color: var(--white);
      padding: 14px 22px;
      font-size: 1.1rem;
      font-weight: 700;
      text-transform: uppercase;
      border-radius: 14px;
      box-shadow: 0 6px 16px rgba(37, 211, 102, 0.4);
      border: 2px solid var(--white);
      text-decoration: none;
      margin-top: 20px;
      transition: all 0.2s ease;
    }

    .whatsapp-btn:hover, .whatsapp-btn:focus {
      background: linear-gradient(45deg, #1EBE54, var(--whatsapp-color));
      box-shadow: 0 8px 20px rgba(37, 211, 102, 0.6);
      transform: scale(1.05);
      outline: none;
    }

    .whatsapp-btn svg {
      width: 24px;
      height: 24px;
    }

    @keyframes pulse {
      0% { transform: scale(1); }
      50% { transform: scale(1.03); }
      100% { transform: scale(1); }
    }

    @media (max-width: 768px) {
      #submit-btn, .whatsapp-btn {
        padding: 12px 18px;
        font-size: 1rem;
        border-radius: 12px;
      }
    }

    .form-section {
      margin-bottom: 30px;
      background: rgba(255, 255, 255, 0.95);
      padding: 25px;
      border-radius: var(--border-radius);
      box-shadow: var(--shadow);
    }

    .equipamento-tabela {
      width: 100%;
      border-collapse: collapse;
      margin: 10px 0;
    }

    .equipamento-tabela th, .equipamento-tabela td {
      padding: 10px;
      text-align: left;
      border-bottom: 1px solid #ddd;
    }

    .equipamento-tabela th {
      background-color: rgba(249, 168, 37, 0.1);
      font-weight: 600;
    }

    .equipamento-tabela td input[type="checkbox"] {
      width: auto;
      margin: 0;
      accent-color: var(--primary-color);
    }

    .equipamento-tabela td input[type="text"], 
    .equipamento-tabela td input[type="number"] {
      padding: 8px;
      margin: 0;
      width: 100%;
    }

    .equipamento-tabela .remover-btn {
      background-color: var(--error-color);
      padding: 8px;
      font-size: 0.9rem;
      white-space: nowrap;
    }

    .equipamento-tabela .remover-btn:hover {
      background-color: #B71C1C;
    }

    @media (max-width: 768px) {
      .equipamento-tabela {
        display: block;
        overflow-x: auto;
      }
      .equipamento-tabela th, .equipamento-tabela td {
        padding: 8px;
        font-size: 0.85rem;
      }
    }

    #resultado-final {
      display: none;
      background-color: var(--white);
      border-radius: var(--border-radius);
      padding: 30px;
      text-align: center;
    }

    .fade-out {
      animation: fadeOut 0.5s ease-in-out forwards;
    }

    .fade-in {
      animation: fadeIn 0.5s ease-in-out forwards;
    }

    @keyframes fadeOut {
      from { opacity: 1; transform: translateY(0); }
      to { opacity: 0; transform: translateY(-20px); }
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .alert {
      background-color: rgba(255, 255, 255, 0.95);
      padding: 15px;
      border-radius: var(--border-radius);
      margin-bottom: 20px;
      text-align: center;
    }

    .label-with-icon {
      display: flex;
      align-items: center;
      gap: 8px;
      font-weight: 600;
      margin-bottom: 5px;
    }

    .label-with-icon svg {
      width: 20px;
      height: 20px;
      stroke: var(--primary-color);
    }

    small, .helper-text {
      color: var(--text-light);
      font-size: 0.85rem;
      display: block;
      margin-top: 5px;
    }

    .manchete {
      display: flex;
      align-items: center;
      gap: 10px;
      background-color: rgba(249, 168, 37, 0.1);
      padding: 15px;
      border-radius: var(--border-radius);
      margin-bottom: 20px;
      font-weight: 600;
      color: var(--text-color);
    }

    .manchete svg {
      width: 24px;
      height: 24px;
      stroke: var(--primary-color);
    }

    .manchete a {
      color: var(--secondary-color);
      text-decoration: underline;
    }

    .manchete a:hover {
      color: var(--secondary-dark);
    }

    .resultado-topicos {
      list-style: none;
      padding: 0 15px;
      margin: 20px 0;
      text-align: left;
    }

    .resultado-topicos li {
      display: flex;
      align-items: flex-start;
      gap: 12px;
      margin-bottom: 12px;
      padding: 14px;
      font-size: 1rem;
      background-color: rgba(2, 136, 209, 0.05);
      border-radius: 8px;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
    }

    .resultado-topicos li.dynamic {
      font-size: 1.1rem;
      font-weight: 600;
      background-color: rgba(249, 168, 37, 0.1);
    }

    .resultado-topicos li svg {
      width: 20px;
      height: 20px;
      flex-shrink: 0;
      margin-top: 2px;
    }

    .resultado-topicos li .piada {
      font-style: italic;
      color: var(--text-light);
      font-size: 0.95rem;
      margin-top: 5px;
      display: block;
    }

    @media (max-width: 768px) {
      .resultado-topicos li {
        font-size: 0.9rem;
        padding: 12px;
      }
      .resultado-topicos li.dynamic {
        font-size: 1rem;
      }
      .resultado-topicos li .piada {
        font-size: 0.8rem;
      }
    }

    .quiz-options {
      display: flex;
      flex-wrap: wrap;
      gap: 15px;
      justify-content: center;
      margin-top: 20px;
    }

    .quiz-btn {
      display: flex;
      align-items: center;
      gap: 10px;
      background: linear-gradient(45deg, var(--primary-color), var(--primary-dark));
      color: var(--white);
      padding: 12px 20px;
      border-radius: var(--border-radius);
      border: none;
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      transition: transform 0.2s, box-shadow 0.2s;
    }

    .quiz-btn:hover, .quiz-btn:focus {
      transform: scale(1.05);
      box-shadow: 0 6px 16px rgba(249, 168, 37, 0.4);
      outline: none;
    }

    .quiz-btn svg {
      width: 20px;
      height: 20px;
    }

    .progress-bar {
      background-color: rgba(255, 255, 255, 0.5);
      border-radius: var(--border-radius);
      height: 12px;
      margin: 20px 0;
      box-shadow: var(--shadow);
    }

    .progress {
      background: linear-gradient(45deg, var(--primary-color), var(--primary-dark));
      height: 100%;
      border-radius: var(--border-radius);
      transition: width 0.4s ease;
    }

    .medidor-economia {
      margin: 20px 0;
      text-align: center;
    }

    .medidor-economia p {
      font-size: 1.3rem;
      font-weight: 700;
      color: var(--text-color);
      margin-bottom: 10px;
    }

    .medidor-progress {
      height: 20px;
    }

    #progress-economia {
      background: linear-gradient(45deg, var(--secondary-color), var(--secondary-dark));
    }

    .form-navigation {
      display: flex;
      gap: 15px;
      margin-top: 20px;
    }

    .form-navigation button {
      flex: 1;
      padding: 14px;
      font-size: 1.1rem;
      border-radius: var(--border-radius);
    }

    .form-navigation button:first-child {
      background: linear-gradient(45deg, #666, #555);
    }

    .form-navigation button:first-child:hover {
      background: linear-gradient(45deg, #555, #444);
    }

    .form-step h3 {
      margin-bottom: 15px;
    }

    .form-step p {
      margin: 10px 0;
    }

    .error-message {
      color: var(--error-color);
      font-size: 0.8rem;
      margin-top: -5px;
      margin-bottom: 5px;
      display: none;
    }

    .input-error {
      border-color: var(--error-color);
    }

    .input-success {
      border-color: var(--success-color);
    }

    .back-to-top {
      margin-top: 20px;
      background: linear-gradient(45deg, #666, #555);
    }

    .back-to-top:hover {
      background: linear-gradient(45deg, #555, #444);
    }

    .skip-link {
      position: absolute;
      top: -40px;
      left: 0;
      background: var(--primary-color);
      color: white;
      padding: 8px;
      z-index: 100;
      transition: top 0.3s;
    }

    .skip-link:focus {
      top: 0;
    }

    @media (max-width: 768px) {
      .quiz-options {
        flex-direction: column;
        align-items: stretch;
      }
      .quiz-btn {
        padding: 10px;
        font-size: 0.9rem;
      }
      .progress-bar {
        height: 10px;
      }
      .medidor-progress {
        height: 15px;
      }
      .form-navigation button {
        padding: 12px;
        font-size: 1rem;
      }
    }
  </style>
</head>
<body>
  <a href="#main-content" class="skip-link">Pular para o conte√∫do principal</a>

  <!-- Quiz Inicial -->
  <div id="quiz-inicial" class="form-section">
    <h2>
      <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#F9A825" stroke-width="2">
        <path d="M12 3v2m0 14v2m9-9h-2m-14 0H3m16.95-6.95l-1.414 1.414M6.465 17.535l-1.414 1.414" />
        <circle cx="12" cy="12" r="4" />
      </svg>
      Comece sua jornada solar!
    </h2>
    <p>Qual √© seu principal objetivo com energia solar?</p>
    <div class="quiz-options">
      <button type="button" class="quiz-btn" data-value="economia" onclick="startSimulation('economia')" aria-label="Reduzir a conta de energia">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#FFFFFF">
          <path d="M12 2v20M2 12h20" />
        </svg>
        Reduzir a conta
      </button>
      <button type="button" class="quiz-btn" data-value="sustentabilidade" onclick="startSimulation('sustentabilidade')" aria-label="Proteger o planeta com energia sustent√°vel">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#FFFFFF">
          <path d="M12 3c-2.67 4-4 6.33-4 9s1.33 5 4 9" />
        </svg>
        Proteger o planeta
      </button>
      <button type="button" class="quiz-btn" data-value="independencia" onclick="startSimulation('independencia')" aria-label="Ser independente da rede el√©trica">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#FFFFFF">
          <rect x="3" y="6" width="18" height="12" rx="2" />
        </svg>
        Ser independente
      </button>
    </div>
  </div>

  <!-- Formul√°rio -->
  <div id="formulario" style="display:none;" aria-labelledby="form-title">
    <h1 id="form-title">
      <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="#F9A825" stroke-width="2">
        <path d="M12 3v2m0 14v2m9-9h-2m-14 0H3m16.95-6.95l-1.414 1.414M6.465 17.535l-1.414 1.414" />
        <circle cx="12" cy="12" r="4" />
      </svg>
      Simulador de Sistema Solar
    </h1>
    <div class="manchete">
      <svg viewBox="0 0 24 24" fill="none" stroke="#F9A825" stroke-width="2">
        <path d="M12 2v2m0 16v2M2 12h2m16 0h2M4.93 4.93l1.41 1.41m11.31 11.31l1.41 1.41" />
        <circle cx="12" cy="12" r="3" />
      </svg>
      üö® Tarifas de energia disparando! Proteja-se com energia solar. <a href="https://www.reuters.com/business/energy/brazil-offer-tax-breaks-lure-data-center-investments-sources-say-2025-04-28/" target="_blank" rel="noopener noreferrer">Saiba mais</a>
    </div>
    <p class="alert">Preencha 3 etapas para descobrir sua economia!</p>
    
    <div class="progress-bar" role="progressbar" aria-valuenow="33" aria-valuemin="0" aria-valuemax="100">
      <div class="progress" id="progress" style="width: 33.33%;"></div>
    </div>
    
    <form id="form-solar" novalidate autocomplete="off" aria-label="Formul√°rio de simula√ß√£o de energia solar">
      <div class="form-step" id="step1" aria-labelledby="step1-title">
        <div class="form-section">
          <h3 id="step1-title">Informa√ß√µes Pessoais</h3>
          <label for="nome" class="label-with-icon">
            <svg viewBox="0 0 24 24" fill="none" stroke="#F9A825" stroke-width="2">
              <circle cx="12" cy="7" r="4" />
              <path d="M5 19a7 7 0 0114 0H5" />
            </svg>
            Nome:
          </label>
          <input type="text" id="nome" name="nome" required aria-required="true">
          <div id="nome-error" class="error-message" role="alert">Por favor, insira seu nome completo</div>

          <label for="telefone" class="label-with-icon">
            <svg viewBox="0 0 24 24" fill="none" stroke="#F9A825" stroke-width="2">
              <path d="M3 5h3l1 5-3 3 5-7h3l-4 10h7l3-3" />
            </svg>
            Telefone:
          </label>
          <input type="tel" id="telefone" name="telefone" required aria-required="true" pattern="\(\d{2}\) \d{5}-\d{4}" placeholder="(00) 00000-0000">
          <div id="telefone-error" class="error-message" role="alert">Por favor, insira um telefone v√°lido</div>
          <small>Formato: (DDD) 00000-0000</small>

          <label for="cpf" class="label-with-icon">
            <svg viewBox="0 0 24 24" fill="none" stroke="#F9A825" stroke-width="2">
              <rect x="3" y="4" width="18" height="16" rx="2" />
              <path d="M7 8h10M7 12h10M7 16h6" />
            </svg>
            CPF:
          </label>
          <input type="text" id="cpf" name="cpf" required aria-required="true" pattern="\d{3}\.\d{3}\.\d{3}-\d{2}" placeholder="000.000.000-00">
          <div id="cpf-error" class="error-message" role="alert">Por favor, insira um CPF v√°lido</div>
          <small>Formato: 000.000.000-00</small>

          <label for="cep" class="label-with-icon">
            <svg viewBox="0 0 24 24" fill="none" stroke="#F9A825" stroke-width="2">
              <path d="M12 2a7 7 0 00-7 7c0 5 7 13 7 13s7-8 7-13a7 7 0 00-7-7z" />
              <circle cx="12" cy="9" r="2" />
            </svg>
            CEP:
          </label>
          <input type="text" id="cep" name="cep" required aria-required="true" pattern="\d{5}-\d{3}" placeholder="00000-000">
          <div id="cep-error" class="error-message" role="alert">Por favor, insira um CEP v√°lido</div>
          <small>Formato: 00000-000</small>
        </div>
        <div class="form-navigation">
          <button type="button" onclick="nextStep(1)" id="next-step1">Pr√≥ximo</button>
        </div>
      </div>

      <div class="form-step" id="step2" style="display:none;" aria-labelledby="step2-title">
        <div class="form-section">
          <h3 id="step2-title">Consumo de Energia</h3>
          <div class="medidor-economia">
            <p>Economia estimada por ano: <span id="economia-valor">R$ 0,00</span></p>
            <div class="progress-bar medidor-progress" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="10000">
              <div class="progress" id="progress-economia" style="width: 0%;"></div>
            </div>
          </div>
          <label for="rua" class="label-with-icon">
            <svg viewBox="0 0 24 24" fill="none" stroke="#F9A825" stroke-width="2">
              <path d="M3 9l9-7 9 7v11a2 2 0 01-2 2H5a2 2 0 01-2-2V9z" />
              <path d="M9 22V12h6v10" />
            </svg>
            Rua:
          </label>
          <input type="text" id="rua" name="rua" readonly aria-readonly="true">

          <label for="bairro" class="label-with-icon">
            <svg viewBox="0 0 24 24" fill="none" stroke="#F9A825" stroke-width="2">
              <rect x="3" y="3" width="18" height="18" rx="2" />
              <path d="M12 8v8M8 12h8" />
            </svg>
            Bairro:
          </label>
          <input type="text" id="bairro" name="bairro" readonly aria-readonly="true">

          <label for="conta_energia" class="label-with-icon">
            <svg viewBox="0 0 24 24" fill="none" stroke="#F9A825" stroke-width="2">
              <rect x="3" y="3" width="18" height="18" rx="2" />
              <circle cx="12" cy="10" r="2" />
              <path d="M7 21l5-5 5 5" />
            </svg>
            Conta de Luz (imagem):
          </label>
          <input type="file" id="conta_energia" name="conta_energia" accept="image/*" required aria-required="true">
          <div id="conta_energia-error" class="error-message" role="alert">Por favor, envie uma imagem da sua conta de luz</div>
          <small>Envie uma foto ou print da sua conta de energia (m√°x. 5MB)</small>

          <label for="consumo" class="label-with-icon">
            <svg viewBox="0 0 24 24" fill="none" stroke="#F9A825" stroke-width="2">
              <circle cx="12" cy="12" r="10" />
              <path d="M12 6v6h4" />
            </svg>
            Consumo mensal atual (kWh):
          </label>
          <input type="number" id="consumo" name="consumo" min="1" required aria-required="true">
          <div id="consumo-error" class="error-message" role="alert">Por favor, insira um valor v√°lido (m√≠nimo 1 kWh)</div>
          <small>Voc√™ encontra esta informa√ß√£o na sua conta de luz</small>

          <label for="sol" class="label-with-icon">
            <svg viewBox="0 0 24 24" fill="none" stroke="#F9A825" stroke-width="2">
              <circle cx="12" cy="12" r="4" />
              <path d="M12 3v2m0 14v2m9-9h-2m-14 0H3m16.95-6.95l-1.414 1.414M6.465 17.535l-1.414 1.414" />
            </svg>
            Horas de sol por dia:
          </label>
          <input type="number" step="0.1" id="sol" name="sol" required aria-required="true" min="3" max="7">
          <div id="sol-error" class="error-message" role="alert">Horas de sol devem estar entre 3.0 e 7.0</div>
          <small>Estimativa baseada no estado. Ajuste conforme condi√ß√µes locais.</small>

          <label>Aparelhos futuros (kWh/m√™s):</label>
          <table class="equipamento-tabela" id="equipamentos-tabela" aria-label="Lista de equipamentos el√©tricos">
            <thead>
              <tr>
                <th scope="col">Selecionar</th>
                <th scope="col">Aparelho</th>
                <th scope="col">Consumo (kWh/m√™s)</th>
                <th scope="col">A√ß√£o</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><input type="checkbox" id="geladeira" class="equipamento-checkbox" onchange="calcularPlacas(); atualizarMedidorEconomia()"></td>
                <td><input type="text" value="Geladeira" readonly aria-label="Geladeira"></td>
                <td><input type="number" value="250" readonly min="0" aria-label="Consumo da geladeira"></td>
                <td></td>
              </tr>
              <tr>
                <td><input type="checkbox" id="fogao" class="equipamento-checkbox" onchange="calcularPlacas(); atualizarMedidorEconomia()"></td>
                <td><input type="text" value="Fog√£o de Indu√ß√£o" readonly aria-label="Fog√£o de Indu√ß√£o"></td>
                <td><input type="number" value="150" readonly min="0" aria-label="Consumo do fog√£o de indu√ß√£o"></td>
                <td></td>
              </tr>
              <tr>
                <td><input type="checkbox" id="carro" class="equipamento-checkbox" onchange="calcularPlacas(); atualizarMedidorEconomia()"></td>
                <td><input type="text" value="Carro El√©trico" readonly aria-label="Carro El√©trico"></td>
                <td><input type="number" value="300" readonly min="0" aria-label="Consumo do carro el√©trico"></td>
                <td></td>
              </tr>
              <tr>
                <td><input type="checkbox" id="arcondicionado" class="equipamento-checkbox" onchange="calcularPlacas(); atualizarMedidorEconomia()"></td>
                <td><input type="text" value="Ar-Condicionado" readonly aria-label="Ar-Condicionado"></td>
                <td><input type="number" value="120" readonly min="0" aria-label="Consumo do ar-condicionado"></td>
                <td></td>
              </tr>
              <tr>
                <td><input type="checkbox" id="maquina" class="equipamento-checkbox" onchange="calcularPlacas(); atualizarMedidorEconomia()"></td>
                <td><input type="text" value="M√°quina de Lavar" readonly aria-label="M√°quina de Lavar"></td>
                <td><input type="number" value="60" readonly min="0" aria-label="Consumo da m√°quina de lavar"></td>
                <td></td>
              </tr>
              <tr>
                <td><input type="checkbox" id="microondas" class="equipamento-checkbox" onchange="calcularPlacas(); atualizarMedidorEconomia()"></td>
                <td><input type="text" value="Micro-ondas" readonly aria-label="Micro-ondas"></td>
                <td><input type="number" value="30" readonly min="0" aria-label="Consumo do micro-ondas"></td>
                <td></td>
              </tr>
              <tr class="equipamento-personalizado">
                <td><input type="checkbox" class="equipamento-checkbox" onchange="calcularPlacas(); atualizarMedidorEconomia()"></td>
                <td><input type="text" placeholder="Ex.: Ventilador de Teto" class="equipamento-nome" aria-label="Nome do equipamento personalizado"></td>
                <td><input type="number" min="0" placeholder="Consumo kWh" class="equipamento-consumo" oninput="calcularPlacas(); atualizarMedidorEconomia()" aria-label="Consumo do equipamento personalizado"></td>
                <td><button type="button" class="remover-btn" onclick="removerEquipamento(this)" aria-label="Remover equipamento">Remover</button></td>
              </tr>
            </tbody>
          </table>
          <button type="button" onclick="adicionarEquipamentoPersonalizado()" aria-label="Adicionar novo equipamento">Adicionar Aparelho</button>
        </div>
        <div class="form-navigation">
          <button type="button" onclick="prevStep(2)">Voltar</button>
          <button type="button" onclick="nextStep(2)" id="next-step2">Pr√≥ximo</button>
        </div>
      </div>

      <div class="form-step" id="step3" style="display:none;" aria-labelledby="step3-title">
        <div class="form-section">
          <h3 id="step3-title">Confirma√ß√£o dos Dados</h3>
          <p><strong>Nome:</strong> <span id="review-nome"></span></p>
          <p><strong>Telefone:</strong> <span id="review-telefone"></span></p>
          <p><strong>CPF:</strong> <span id="review-cpf"></span></p>
          <p><strong>CEP:</strong> <span id="review-cep"></span></p>
          <p><strong>Consumo mensal:</strong> <span id="review-consumo"></span> kWh</p>
          <p><strong>Horas de sol:</strong> <span id="review-sol"></span></p>
          <p><strong>Aparelhos adicionais:</strong> <span id="review-equipamentos"></span></p>
        </div>
        <div class="form-navigation">
          <button type="button" onclick="prevStep(3)">Voltar</button>
          <button type="submit" id="submit-btn">DESCOBRIR ECONOMIA!</button>
        </div>
      </div>
    </form>
  </div>

  <div id="resultado-final" aria-live="polite" aria-labelledby="result-title">
    <h2 id="result-title">Resultado da Simula√ß√£o</h2>
    <div class="manchete">
      <svg viewBox="0 0 24 24" fill="none" stroke="#F9A825" stroke-width="2">
        <path d="M12 2v2m0 16v2M2 12h2m16 0h2M4.93 4.93l1.41 1.41m11.31 11.31l1.41 1.41" />
        <circle cx="12" cy="12" r="3" />
      </svg>
      üö® Tarifas de energia disparando! Proteja-se com energia solar. <a href="https://www.reuters.com/business/energy/brazil-offer-tax-breaks-lure-data-center-investments-sources-say-2025-04-28/" target="_blank" rel="noopener noreferrer">Saiba mais</a>
    </div>
    <ul class="resultado-topicos">
      <li id="resultado-simples" class="dynamic">
        <svg viewBox="0 0 24 24" fill="none" stroke="#F9A825" stroke-width="2">
          <rect x="3" y="3" width="18" height="18" rx="2" />
          <path d="M12 8v8M8 12h8" />
        </svg>
        <span class="texto"></span>
      </li>
      <li id="area-placas" class="dynamic">
        <svg viewBox="0 0 24 44" fill="none" stroke="#F9A825" stroke-width="2">
          <rect x="3" y="3" width="18" height="12" rx="2" />
          <path d="M3 9h18M9 3v12" />
        </svg>
        <span class="texto"></span>
      </li>
      <li id="economia-10-anos" class="dynamic">
        <svg viewBox="0 0 24 24" fill="none" stroke="#F9A825" stroke-width="2">
          <path d="M12 2v20M2 12h20" />
          <circle cx="12" cy="12" r="2" />
        </svg>
        <span class="texto"></span>
      </li>
      <h3>Benef√≠cios da Energia Solar</h3>
      <li>
        <svg viewBox="0 0 24 24" fill="none" stroke="#F9A825" stroke-width="2">
          <path d="M12 2v4m0 12v4M2 12h4m12 0h4M4.93 4.93l2.83 2.83m8.48 8.48l2.83 2.83" />
          <circle cx="12" cy="12" r="3" />
        </svg>
        <span class="texto"><strong>Economia Imbat√≠vel:</strong> Reduza sua conta drasticamente.</span>
      </li>
      <li>
        <svg viewBox="0 0 24 24" fill="none" stroke="#F9A825" stroke-width="2">
          <path d="M3 12a9 9 0 1118 0 9 9 0 01-18 0z" />
          <path d="M12 3c-2.67 4-4 6.33-4 9s1.33 5 4 9" />
        </svg>
        <span class="texto"><strong>Sustentabilidade:</strong> Contribua para um planeta limpo.</span>
      </li>
      <li>
        <svg viewBox="0 0 24 24" fill="none" stroke="#F9A825" stroke-width="2">
          <path d="M3 9l9-7 9 7v11a2 2 0 01-2 2H5a2 2 0 01-2-2V9z" />
          <path d="M9 22V12h6v10" />
        </svg>
        <span class="texto"><strong>Valoriza√ß√£o do Im√≥vel:</strong> Casas com pain√©is s√£o mais valorizadas.</span>
      </li>
      <li>
        <svg viewBox="0 0 24 24" fill="none" stroke="#F9A825" stroke-width="2">
          <rect x="3" y="6" width="18" height="12" rx="2" />
          <path d="M12 3v3m0 12v3" />
        </svg>
        <span class="texto"><strong>Independ√™ncia:</strong> Gere sua pr√≥pria energia!</span>
      </li>
    </ul>
    <p>Um especialista entrar√° em contato em breve.</p>
    <a href="https://wa.me/+5511995305094?text=Quero%20um%20or√ßamento%20para%20energia%20solar!" class="whatsapp-btn" target="_blank" rel="noopener noreferrer" aria-label="Fale conosco no WhatsApp">
      <svg viewBox="0 0 24 24" fill="none" stroke="#FFFFFF" stroke-width="2">
        <path d="M3 21l1.65-3.8a9 9 0 113.8 3.8L3 21z" fill="#25D366" stroke="#25D366"/>
        <path d="M16 13.5l-1.5-1.5-2.5 2.5-2.5-2.5-1.5 1.5 2.5 2.5 2.5-2.5 2.5 2.5z" fill="#FFFFFF"/>
      </svg>
      FALE CONOSCO AGORA!
    </a>
    <button type="button" class="back-to-top" onclick="voltarAoInicio()">Voltar ao in√≠cio</button>
  </div>

  <script>
    // Constantes
    const POTENCIA_PLACA = 550; // Watts
    const EFICIENCIA_SISTEMA = 0.8; // 80%
    const MARGEM_SEGURANCA = 1.2; // 20%
    const MAX_FILE_SIZE = 5 * 1024 * 1024; // 5MB
    const CUSTO_KWH = 0.90; // R$/kWh
    const INFLACAO_ANUAL = 0.04; // 4%
    const DEGRADACAO_ANUAL = 0.005; // 0.5%
    const AREA_POR_PLACA = 2; // m¬≤

    const horasSolPorEstado = {
      'SP': 5.0, 'RJ': 5.2, 'MG': 5.3, 'RS': 4.8, 'SC': 4.7, 'PR': 4.9, 'BA': 5.5,
      'PE': 5.6, 'CE': 5.8, 'GO': 5.4, 'DF': 5.4, 'MT': 5.5, 'MS': 5.3, 'AM': 4.5,
      'PA': 4.6, 'MA': 5.3, 'PI': 5.7, 'RN': 5.8, 'PB': 5.6, 'SE': 5.5, 'AL': 5.5,
      'TO': 5.6, 'RO': 4.8, 'AC': 4.5, 'RR': 4.7, 'AP': 4.6
    };

    const piadasEconomia = [
      "Com {valor}, d√° pra comprar caf√© pra acordar o bairro inteiro!",
      "Essa economia de {valor} paga uma viagem pra curtir o sol sem culpa!",
      "Com {valor}? Isso √© pizza suficiente pra uma festa de 10 anos!",
      "Com {valor} economizados, d√° pra montar um cinema em casa!",
      "Essa grana de {valor} paga um churrasco que vai virar lenda!",
      "Com {valor}? √â como ganhar um b√¥nus pra curtir a vida!",
      "Com {valor}, d√° pra comprar um estoque de sorvete pro ver√£o!",
      "Essa economia de {valor} √© tipo um presente do sol!",
      "Com {valor} economizados? Hora de planejar uma aventura √©pica!",
      "Com {valor}, d√° pra encher a casa de gadgets solares!"
    ];

    // Fun√ß√µes de Formata√ß√£o e Utilit√°rios
    function formatarValor(valor) {
      return `R$ ${parseFloat(valor).toFixed(2).replace('.', ',').replace(/\B(?=(\d{3})+(?!\d))/g, '.')}`;
    }

    function getPiadaAleatoria(economia) {
      const index = Math.floor(Math.random() * piadasEconomia.length);
      return piadasEconomia[index].replace('{valor}', formatarValor(economia));
    }

    function sanitizarInput(value) {
      const div = document.createElement('div');
      div.textContent = value;
      return div.innerHTML;
    }

    function validarCampo(campo, regex, mensagemErro) {
      const errorElement = document.getElementById(`${campo.id}-error`);
      
      if (!campo.value || (regex && !regex.test(campo.value))) {
        campo.classList.add('input-error');
        campo.classList.remove('input-success');
        errorElement.style.display = 'block';
        return false;
      } else {
        campo.classList.remove('input-error');
        campo.classList.add('input-success');
        errorElement.style.display = 'none';
        return true;
      }
    }

    function validarPasso(passo) {
      let valido = true;
      
      if (passo === 1) {
        const campos = [
          { id: 'nome', regex: null },
          { id: 'telefone', regex: /^\(\d{2}\) \d{5}-\d{4}$/ },
          { id: 'cpf', regex: /^\d{3}\.\d{3}\.\d{3}-\d{2}$/ },
          { id: 'cep', regex: /^\d{5}-\d{3}$/ }
        ];
        
        campos.forEach(({ id, regex }) => {
          const campo = document.getElementById(id);
          if (!validarCampo(campo, regex, `Por favor, preencha o campo ${id}`)) {
            valido = false;
          }
        });
      } else if (passo === 2) {
        const campos = [
          { id: 'consumo', regex: /^[1-9]\d*$/ },
          { id: 'sol', regex: /^[3-7](\.\d)?$/ }
        ];
        
        campos.forEach(({ id, regex }) => {
          const campo = document.getElementById(id);
          if (!validarCampo(campo, regex, `Por favor, preencha o campo ${id}`)) {
            valido = false;
          }
        });
        
        const contaEnergia = document.getElementById('conta_energia');
        if (!contaEnergia.files || contaEnergia.files.length === 0) {
          document.getElementById('conta_energia-error').style.display = 'block';
          valido = false;
        } else {
          document.getElementById('conta_energia-error').style.display = 'none';
        }
      }
      
      return valido;
    }

    // Fun√ß√µes de Equipamentos
    function adicionarEquipamentoPersonalizado() {
      const tbody = document.querySelector('#equipamentos-tabela tbody');
      const tr = document.createElement('tr');
      tr.className = 'equipamento-personalizado';
      tr.innerHTML = `
        <td><input type="checkbox" class="equipamento-checkbox" onchange="calcularPlacas(); atualizarMedidorEconomia()" aria-label="Selecionar equipamento"></td>
        <td><input type="text" placeholder="Ex.: Ventilador de Teto" class="equipamento-nome" aria-label="Nome do equipamento"></td>
        <td><input type="number" min="0" placeholder="Consumo kWh" class="equipamento-consumo" oninput="calcularPlacas(); atualizarMedidorEconomia()" aria-label="Consumo do equipamento"></td>
        <td><button type="button" class="remover-btn" onclick="removerEquipamento(this)" aria-label="Remover equipamento">Remover</button></td>
      `;
      tbody.appendChild(tr);
      tr.querySelector('.equipamento-nome').focus();
    }

    function removerEquipamento(btn) {
      btn.closest('tr').remove();
      calcularPlacas();
      atualizarMedidorEconomia();
    }

    // M√°scaras de Input
    function aplicarMascaras() {
      const cpf = document.getElementById('cpf');
      const telefone = document.getElementById('telefone');
      const cep = document.getElementById('cep');

      cpf.addEventListener('input', (e) => {
        let value = e.target.value.replace(/\D/g, '');
        if (value.length > 11) value = value.slice(0, 11);
        e.target.value = value.replace(/(\d{3})(\d{3})(\d{3})(\d{2})/, '$1.$2.$3-$4');
      });

      telefone.addEventListener('input', (e) => {
        let value = e.target.value.replace(/\D/g, '');
        if (value.length > 11) value = value.slice(0, 11);
        e.target.value = value.replace(/(\d{2})(\d{5})(\d{4})/, '($1) $2-$3');
      });

      cep.addEventListener('input', (e) => {
        let value = e.target.value.replace(/\D/g, '');
        if (value.length > 8) value = value.slice(0, 8);
        e.target.value = value.replace(/(\d{5})(\d{3})/, '$1-$2');
      });
    }

    // Valida√ß√£o de Arquivo
    document.getElementById('conta_energia').addEventListener('change', function (e) {
      const file = e.target.files[0];
      if (file && file.size > MAX_FILE_SIZE) {
        alert('A imagem deve ter no m√°ximo 5MB.');
        e.target.value = '';
        document.getElementById('conta_energia-error').textContent = 'O arquivo √© muito grande (m√°x. 5MB)';
        document.getElementById('conta_energia-error').style.display = 'block';
      } else {
        document.getElementById('conta_energia-error').style.display = 'none';
      }
    });

    // C√°lculos
    function calcularPlacas() {
      const consumo = parseFloat(document.getElementById('consumo').value) || 0;
      const horasSol = parseFloat(document.getElementById('sol').value) || 0;

      if (consumo <= 0 || horasSol <= 0) {
        return 0;
      }

      let adicional = 0;
      const equipamentosSelecionados = [];
      document.querySelectorAll('#equipamentos-tabela tr').forEach(tr => {
        const checkbox = tr.querySelector('.equipamento-checkbox');
        const consumoInput = tr.querySelector('input[type="number"]');
        if (checkbox && checkbox.checked && consumoInput && consumoInput.value) {
          adicional += parseFloat(consumoInput.value) || 0;
          const nomeInput = tr.querySelector('input[type="text"]');
          equipamentosSelecionados.push({
            nome: sanitizarInput(nomeInput.value || 'Aparelho sem nome'),
            consumo: parseFloat(consumoInput.value) || 0
          });
        }
      });

      // Atualiza a revis√£o de equipamentos
      const equipamentosReview = equipamentosSelecionados.map(e => `${e.nome} (${e.consumo}kWh)`).join(', ') || 'Nenhum';
      document.getElementById('review-equipamentos').textContent = equipamentosReview;

      const consumoTotal = (consumo + adicional) * MARGEM_SEGURANCA;
      const energiaPorPlaca = (POTENCIA_PLACA * horasSol * 30 * EFICIENCIA_SISTEMA) / 1000;

      return energiaPorPlaca > 0 ? Math.ceil(consumoTotal / energiaPorPlaca) : 0;
    }

    function calcularEconomia10Anos(consumo, adicional) {
      const consumoAnual = (consumo + adicional) * 12;
      let economiaTotal = 0;

      for (let ano = 0; ano < 10; ano++) {
        const eficiencia = Math.pow(1 - DEGRADACAO_ANUAL, ano);
        const custoAjustado = CUSTO_KWH * Math.pow(1 + INFLACAO_ANUAL, ano);
        const economiaAnual = consumoAnual * eficiencia * custoAjustado;
        economiaTotal += economiaAnual;
      }

      return economiaTotal.toFixed(2);
    }

    // Medidor de Economia
    function atualizarMedidorEconomia() {
      try {
        const consumo = parseFloat(document.getElementById('consumo').value) || 0;
        let adicional = 0;
        document.querySelectorAll('#equipamentos-tabela tr').forEach(tr => {
          const checkbox = tr.querySelector('.equipamento-checkbox');
          const consumoInput = tr.querySelector('input[type="number"]');
          if (checkbox && checkbox.checked && consumoInput && consumoInput.value) {
            adicional += parseFloat(consumoInput.value) || 0;
          }
        });
        const economiaAnual = (consumo + adicional) * 12 * CUSTO_KWH;
        document.getElementById('economia-valor').innerText = formatarValor(economiaAnual);
        const progresso = Math.min((economiaAnual / 10000) * 100, 100);
        document.getElementById('progress-economia').style.width = `${progresso}%`;
        document.querySelector('.medidor-progress').setAttribute('aria-valuenow', Math.round(economiaAnual));
      } catch (error) {
        console.error('Erro ao atualizar medidor:', error);
      }
    }

    // Navega√ß√£o
    function startSimulation(objetivo) {
      try {
        document.getElementById('quiz-inicial').style.display = 'none';
        document.getElementById('formulario').style.display = 'block';
        document.getElementById('form-title').focus();
        window.quizObjetivo = objetivo;
      } catch (error) {
        console.error('Erro ao iniciar simula√ß√£o:', error);
        alert('Erro ao prosseguir. Tente novamente.');
      }
    }

    function nextStep(current) {
      try {
        if (!validarPasso(current)) {
          return;
        }

        const currentStep = document.getElementById(`step${current}`);
        const nextStep = document.getElementById(`step${current + 1}`);
        if (!currentStep || !nextStep) return;

        currentStep.style.display = 'none';
        nextStep.style.display = 'block';
        const progresso = 33.33 * (current + 1);
        document.getElementById('progress').style.width = `${progresso}%`;
        document.querySelector('.progress-bar').setAttribute('aria-valuenow', Math.round(progresso));

        if (current === 2) {
          document.getElementById('review-nome').textContent = sanitizarInput(document.getElementById('nome').value || '');
          document.getElementById('review-telefone').textContent = sanitizarInput(document.getElementById('telefone').value || '');
          document.getElementById('review-cpf').textContent = sanitizarInput(document.getElementById('cpf').value || '');
          document.getElementById('review-cep').textContent = sanitizarInput(document.getElementById('cep').value || '');
          document.getElementById('review-consumo').textContent = document.getElementById('consumo').value || '0';
          document.getElementById('review-sol').textContent = document.getElementById('sol').value || '0';
          
          // For√ßar c√°lculo dos equipamentos para mostrar na revis√£o
          calcularPlacas();
        }

        // Focar no primeiro elemento do pr√≥ximo passo
        setTimeout(() => {
          const firstFocusable = nextStep.querySelector('input, button');
          if (firstFocusable) firstFocusable.focus();
        }, 100);
      } catch (error) {
        console.error('Erro ao avan√ßar etapa:', error);
        alert('Erro ao prosseguir. Tente novamente.');
      }
    }

    function prevStep(current) {
      try {
        const currentStep = document.getElementById(`step${current}`);
        const prevStep = document.getElementById(`step${current - 1}`);
        if (!currentStep || !prevStep) return;

        currentStep.style.display = 'none';
        prevStep.style.display = 'block';
        const progresso = 33.33 * (current - 1);
        document.getElementById('progress').style.width = `${progresso}%`;
        document.querySelector('.progress-bar').setAttribute('aria-valuenow', Math.round(progresso));

        // Focar no bot√£o de pr√≥ximo do passo anterior
        setTimeout(() => {
          const prevButton = prevStep.querySelector(`#next-step${current - 1}`);
          if (prevButton) prevButton.focus();
        }, 100);
      } catch (error) {
        console.error('Erro ao voltar etapa:', error);
        alert('Erro ao voltar. Tente novamente.');
      }
    }

    function voltarAoInicio() {
      document.getElementById('resultado-final').style.display = 'none';
      document.getElementById('quiz-inicial').style.display = 'block';
      document.getElementById('quiz-inicial').scrollIntoView();
    }

    // Eventos
    document.getElementById('cep').addEventListener('blur', () => {
      try {
        const cep = document.getElementById('cep').value.replace(/\D/g, '');
        if (cep.length === 8) {
          fetch(`https://viacep.com.br/ws/${cep}/json/`)
            .then(res => {
              if (!res.ok) throw new Error('Erro ao consultar o CEP');
              return res.json();
            })
            .then(data => {
              if (data.erro) {
                alert('CEP inv√°lido');
                return;
              }
              document.getElementById('rua').value = sanitizarInput(data.logradouro || '');
              document.getElementById('bairro').value = sanitizarInput(data.bairro || '');
              const estado = data.uf;
              if (estado && horasSolPorEstado[estado]) {
                const solInput = document.getElementById('sol');
                if (!solInput.value) {
                  solInput.value = horasSolPorEstado[estado];
                }
                calcularPlacas();
                atualizarMedidorEconomia();
              }
            })
            .catch(err => {
              console.error('Erro na consulta de CEP:', err);
              alert('Erro ao buscar o CEP. Tente novamente.');
            });
        }
      } catch (error) {
        console.error('Erro no evento de CEP:', error);
      }
    });

    document.getElementById('sol').addEventListener('input', function () {
      try {
        const valor = parseFloat(this.value);
        if (valor < 3.0 || valor > 7.0) {
          document.getElementById('sol-error').style.display = 'block';
          this.classList.add('input-error');
        } else {
          document.getElementById('sol-error').style.display = 'none';
          this.classList.remove('input-error');
        }
        calcularPlacas();
        atualizarMedidorEconomia();
      } catch (error) {
        console.error('Erro no evento de horas de sol:', error);
      }
    });

    document.getElementById('consumo').addEventListener('input', () => {
      try {
        calcularPlacas();
        atualizarMedidorEconomia();
      } catch (error) {
        console.error('Erro no evento de consumo:', error);
      }
    });

    document.querySelectorAll('.equipamento-checkbox, .equipamento-consumo').forEach(el => {
      el.addEventListener('change', () => {
        try {
          calcularPlacas();
          atualizarMedidorEconomia();
        } catch (error) {
          console.error('Erro no evento de equipamentos:', error);
        }
      });
      el.addEventListener('input', () => {
        try {
          calcularPlacas();
          atualizarMedidorEconomia();
        } catch (error) {
          console.error('Erro no evento de equipamentos:', error);
        }
      });
    });

    document.getElementById('form-solar').addEventListener('submit', function (e) {
      e.preventDefault();
      
      try {
        const consumo = parseFloat(document.getElementById('consumo').value) || 0;
        const horasSol = parseFloat(document.getElementById('sol').value) || 0;
        let adicional = 0;
        const equipamentosSelecionados = [];
        document.querySelectorAll('#equipamentos-tabela tr').forEach(tr => {
          const checkbox = tr.querySelector('.equipamento-checkbox');
          const nomeInput = tr.querySelector('input[type="text"]');
          const consumoInput = tr.querySelector('input[type="number"]');
          if (checkbox && checkbox.checked && consumoInput && consumoInput.value) {
            adicional += parseFloat(consumoInput.value) || 0;
            equipamentosSelecionados.push({
              nome: sanitizarInput(nomeInput.value || 'Aparelho sem nome'),
              consumo: parseFloat(consumoInput.value) || 0
            });
          }
        });

        const placas = calcularPlacas();
        if (placas === 0) {
          alert('Preencha valores v√°lidos para consumo e horas de sol.');
          return;
        }

        const economia = calcularEconomia10Anos(consumo, adicional);
        const area = placas * AREA_POR_PLACA;

        const mensagemObjetivo = window.quizObjetivo === 'economia' ? 'Economia garantida na sua conta!' :
                                window.quizObjetivo === 'sustentabilidade' ? 'Contribua para um planeta mais verde!' :
                                'Independ√™ncia energ√©tica ao seu alcance!';
        document.getElementById('resultado-simples').querySelector('.texto').textContent = `${mensagemObjetivo} Voc√™ precisar√° de ~${placas} placas de ${POTENCIA_PLACA}W.`;
        document.getElementById('area-placas').querySelector('.texto').textContent = `√Årea necess√°ria: ~${area} m¬≤.`;
        document.getElementById('economia-10-anos').querySelector('.texto').innerHTML = `Economia em 10 anos: <strong>${formatarValor(economia)}</strong>.<br><span class="piada">${getPiadaAleatoria(economia)}</span>`;

        const formulario = document.getElementById('formulario');
        const resultado = document.getElementById('resultado-final');
        formulario.classList.add('fade-out');
        setTimeout(() => {
          formulario.style.display = 'none';
          formulario.classList.remove('fade-out');
          resultado.style.display = 'block';
          resultado.classList.add('fade-in');
          setTimeout(() => {
            resultado.classList.remove('fade-in');
            document.getElementById('result-title').focus();
          }, 500);
        }, 500);

        // Simula√ß√£o de envio dos dados
        const formData = new FormData(this);
        const dados = {
          nome: sanitizarInput(formData.get('nome')),
          telefone: sanitizarInput(formData.get('telefone')),
          cpf: sanitizarInput(formData.get('cpf')),
          cep: sanitizarInput(formData.get('cep')),
          rua: sanitizarInput(formData.get('rua')),
          bairro: sanitizarInput(formData.get('bairro')),
          consumo: formData.get('consumo'),
          horas_sol: formData.get('sol'),
          placas: placas,
          area_m2: area,
          economia_10_anos: formatarValor(economia),
          equipamentos: equipamentosSelecionados,
          quiz_objetivo: window.quizObjetivo,
          conta_energia: formData.get('conta_energia') ? 'Arquivo enviado' : 'Nenhum arquivo'
        };
        console.log('Dados do formul√°rio:', dados);
      } catch (error) {
        console.error('Erro ao processar formul√°rio:', error);
        alert('Erro ao processar o formul√°rio.');
      }
    });

    // Inicializa√ß√£o
    document.addEventListener('DOMContentLoaded', () => {
      try {
        aplicarMascaras();
        
        // Adicionar listeners para valida√ß√£o em tempo real
        document.getElementById('nome').addEventListener('blur', () => validarCampo(document.getElementById('nome'), null, ''));
        document.getElementById('telefone').addEventListener('blur', () => validarCampo(document.getElementById('telefone'), /^\(\d{2}\) \d{5}-\d{4}$/, ''));
        document.getElementById('cpf').addEventListener('blur', () => validarCampo(document.getElementById('cpf'), /^\d{3}\.\d{3}\.\d{3}-\d{2}$/, ''));
        document.getElementById('cep').addEventListener('blur', () => validarCampo(document.getElementById('cep'), /^\d{5}-\d{3}$/, ''));
        document.getElementById('consumo').addEventListener('blur', () => validarCampo(document.getElementById('consumo'), /^[1-9]\d*$/, ''));
        document.getElementById('sol').addEventListener('blur', () => validarCampo(document.getElementById('sol'), /^[3-7](\.\d)?$/, ''));
        
        console.log('Simulador inicializado com sucesso');
      } catch (error) {
        console.error('Erro na inicializa√ß√£o:', error);
      }
    });
  </script>
</body>
</html>
